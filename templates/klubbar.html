{% extends "base.html" %}
{% block title %}KLÚBBAR{% endblock %}
{% block content %}

<body>
    <div class="grid">
        <div>
            <h1>Klúbbar</h1>
            {% for i in k %}
            <button class="accordion">{{ i.nafn }}</button>
            <div class="panel">
                <p>Stofa: {{ i.stofa }}</p>
                <p>Formaður: {{ i.formadur }}</p>
                <p>{{ i.desc }}</p>
            </div>
            {% endfor %}
            <button class="stofna">Stofna klúbb +</button>
        </div>
        <div>
            <h1>Stofur</h1>
            <div class="stofur">
            </div>
            <button class="floor">hæð 2</button> <button class="floor">hæð 3</button>


        </div>
      {% endfor %}
      <button class="stofna">Stofna klúbb +</button>
    </div>
    <div>
      <h1>Stofur</h1>
      <div style="border: 1px solid black; width: 600px; height: 400px; overflow: auto; display:flex; align-items:center; justify-content:center; background:#fff;">
        <img id="floor-map" src="{{ url_for('static', filename='floor-2.png') }}" alt="Floor plan" style="max-width:100%; height:auto; display:block;"/>
      </div>
      <button>hæð 2</button> <button>hæð 3</button>
    </div>
  </div>

  {% if is_admin %}
    <a class="admin-edit-btn" href="{{ url_for('klubbar_edit') }}" title="Edit clubs">Edit</a>
  {% endif %}
<script>

    const acc = document.getElementsByClassName("accordion");
    for (let i = 0; i < acc.length; i++) {

        acc[i].addEventListener("click", function () {

            this.classList.toggle("active");
            const panel = this.nextElementSibling;
            const willOpen = !panel.classList.contains("open");

            panel.classList.toggle("open");
            if (willOpen) {
                // Expand to its natural height for smooth animation
                panel.style.maxHeight = panel.scrollHeight + "px";
            } else {
                // Collapse smoothly
                panel.style.maxHeight = null;
            }
        });
    }
    // Floor map toggle without changing markup of buttons
    (function() {
      const mapEl = document.getElementById('floor-map');
      if (!mapEl) return;
      const mapBox = mapEl.parentElement;
      if (!mapBox) return;
      const btn1 = mapBox.nextElementSibling;
      const btn2 = btn1 ? btn1.nextElementSibling : null;
      const floorSrc = {
        '2': "{{ url_for('static', filename='floor-2.png') }}",
        '3': "{{ url_for('static', filename='floor-3.png') }}",
      };
      function setFloor(n) {
        mapEl.src = floorSrc[n] || floorSrc['2'];
      }
      if (btn1 && btn1.tagName === 'BUTTON') {
        btn1.addEventListener('click', () => setFloor('2'));
      }
      if (btn2 && btn2.tagName === 'BUTTON') {
        btn2.addEventListener('click', () => setFloor('3'));
      }
    })();
</script>
{% endblock %}
